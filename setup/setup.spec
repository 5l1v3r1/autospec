#
# This file is auto-generated. DO NOT EDIT
# Generated by: autospec.py
#
Name     : setup
Version  : 2.8.71
Release  : 1
URL      : file:///home/clr/stx-tar/setup-2.8.71.tar.bz2
Source0  : file:///home/clr/stx-tar/setup-2.8.71.tar.bz2
Summary  : A set of system configuration and setup files
Group    : Development/Tools
License  : Domain
Requires: system-release
BuildRequires : bash
BuildRequires : perl
Patch1: setup-2.8.71-securetty-mainframes.patch
Patch2: setup-2.8.71-bashrc-shellvar.patch
Patch3: setup-2.8.71-uidgidchanges.patch
Patch4: setup-2.8.71-filesystems.patch
Patch5: setup-2.8.71-fullpath.patch
Patch6: setup-2.8.71-tapeid.patch
Patch7: setup-2.8.71-shlocal.patch
Patch8: setup-2.8.71-protocolscrudp.patch
Patch9: setup-2.8.71-shellsnologin.patch
Patch10: 0001-Change-group-passwd-and-uidgid.patch
Patch11: 0001-fix-Makefile-command.patch

%description
The setup package contains a set of important system configuration and
setup files, such as passwd, group, and profile.

%prep
%setup -q -n setup-2.8.71
%patch1 -p1
%patch2 -p1
%patch3 -p1
%patch4 -p1
%patch5 -p1
%patch6 -p1
%patch7 -p1
%patch8 -p1
%patch9 -p1
%patch10 -p1
%patch11 -p1

%build
export http_proxy=http://127.0.0.1:9/
export https_proxy=http://127.0.0.1:9/
export no_proxy=localhost,127.0.0.1,0.0.0.0
export LANG=C.UTF-8
export SOURCE_DATE_EPOCH=1569225801
export GCC_IGNORE_WERROR=1
export AR=gcc-ar
export RANLIB=gcc-ranlib
export NM=gcc-nm
export CFLAGS="$CFLAGS -O3 -ffat-lto-objects -flto=4 "
export FCFLAGS="$CFLAGS -O3 -ffat-lto-objects -flto=4 "
export FFLAGS="$CFLAGS -O3 -ffat-lto-objects -flto=4 "
export CXXFLAGS="$CXXFLAGS -O3 -ffat-lto-objects -flto=4 "
make  %{?_smp_mflags}


%install
export SOURCE_DATE_EPOCH=1569225801
rm -rf %{buildroot}
mkdir -p %{buildroot}/usr/local/etc/profile.d
## install_append content
cp -ar * %{buildroot}/usr/local/etc
rm -f %{buildroot}/usr/local/etc/uidgid
rm -f %{buildroot}/usr/local/etc/COPYING
mkdir -p %{buildroot}/var/log
touch %{buildroot}/var/log/lastlog
touch %{buildroot}/usr/local/etc/environment
chmod 0644 %{buildroot}/usr/local/etc/environment
chmod 0644 %{buildroot}/var/log/lastlog
touch %{buildroot}/usr/local/etc/fstab
touch %{buildroot}/usr/local/etc/subuid
touch %{buildroot}/usr/local/etc/subgid
mkdir -p %{buildroot}/usr/local/etc/profile.d
echo "#Add any required envvar overrides to this file, it is sourced from /usr/local/etc/profile" >%{buildroot}/usr/local/etc/profile.d/sh.local
echo "#Add any required envvar overrides to this file, is sourced from /usr/local/etc/csh.login" >%{buildroot}/usr/local/etc/profile.d/csh.local
rm -f %{buildroot}/usr/local/etc/Makefile
rm -f %{buildroot}/usr/local/etc/serviceslint
rm -f %{buildroot}/usr/local/etc/uidgidlint
rm -f %{buildroot}/usr/local/etc/shadowconvert.sh
rm -f %{buildroot}/usr/local/etc/setup.spec
rm -f %{buildroot}/usr/local/etc/securetty.mainframe
rm -f %{buildroot}/usr/local/etc/bashrc.envvar
rm -f %{buildroot}/usr/local/etc/*.orig
## install_append end

%files
%defattr(-,root,root,-)
/usr/local/etc/aliases
/usr/local/etc/bashrc
/usr/local/etc/csh.cshrc
/usr/local/etc/csh.login
/usr/local/etc/environment
/usr/local/etc/exports
/usr/local/etc/filesystems
/usr/local/etc/fstab
/usr/local/etc/group
/usr/local/etc/host.conf
/usr/local/etc/hosts
/usr/local/etc/hosts.allow
/usr/local/etc/hosts.deny
/usr/local/etc/inputrc
/usr/local/etc/motd
/usr/local/etc/passwd
/usr/local/etc/printcap
/usr/local/etc/profile
/usr/local/etc/profile.d/csh.local
/usr/local/etc/profile.d/sh.local
/usr/local/etc/protocols
/usr/local/etc/securetty
/usr/local/etc/services
/usr/local/etc/shells
/usr/local/etc/subgid
/usr/local/etc/subuid
/var/log/lastlog
